#!/bin/sh
while ! grep -q 'Page Setup' /home/user/.config/evince/print-settings; do
  sleep 1
done
file=`grep -oP '(?<=file-name=).*' /home/user/.config/evince/print-settings`
x=`grep -oP '(?<=print-pages=).*' /home/user/.config/evince/print-settings`
(
if [ $x = all ]; then
  cat $file
elif [ $x = current ]; then
  pages=`grep -oP '(?<=current-page=).*' /home/user/.config/evince/print-settings`
  qpdf --pages . $pages -- $file -
elif [ $x = ranges ]; then
  pages=`grep -oP '(?<=page-ranges=).*' /home/user/.config/evince/print-settings`
  qpdf --pages . $pages -- $file -
fi
) >/tmp/out.pdf
